"use strict";(()=>{var e={};e.id=5774,e.ids=[5774],e.modules={11185:e=>{e.exports=require("mongoose")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},14300:e=>{e.exports=require("buffer")},6113:e=>{e.exports=require("crypto")},12781:e=>{e.exports=require("stream")},73837:e=>{e.exports=require("util")},89097:(e,t,r)=>{r.r(t),r.d(t,{headerHooks:()=>h,originalPathname:()=>w,patchFetch:()=>x,requestAsyncStorage:()=>d,routeModule:()=>g,serverHooks:()=>m,staticGenerationAsyncStorage:()=>f,staticGenerationBailout:()=>y});var a={};r.r(a),r.d(a,{GET:()=>u,POST:()=>l});var i=r(95419),n=r(69108),s=r(99678),o=r(47033),p=r(64310),c=r(69059);async function u(e){try{await (0,o.Z)();let{searchParams:t}=new URL(e.url),r=t.get("search"),a=t.get("category"),i=t.get("minPrice"),n=t.get("maxPrice"),s=t.get("sort")||"createdAt",c=t.get("order")||"desc",u=parseInt(t.get("limit")||"20"),l=parseInt(t.get("page")||"1"),g={};r&&(g.$or=[{title:{$regex:r,$options:"i"}},{description:{$regex:r,$options:"i"}}]),a&&(g.category=a),(i||n)&&(g.price={},i&&(g.price.$gte=Number(i)),n&&(g.price.$lte=Number(n)));let d={};d[s]="asc"===c?1:-1;let f=(await p.Z.find(g).sort(d).skip((l-1)*u).limit(u).populate({path:"freelancerId",select:"name",model:"User"})).map(e=>({...e.toObject(),id:e._id,freelancer:e.freelancerId,freelancerId:e.freelancerId._id})),m=await p.Z.countDocuments(g);return new Response(JSON.stringify({gigs:f,pagination:{total:m,page:l,limit:u,pages:Math.ceil(m/u)}}),{status:200,headers:{"Content-Type":"application/json"}})}catch(e){return console.error("Get gigs error:",e),new Response(JSON.stringify({message:"Server error"}),{status:500,headers:{"Content-Type":"application/json"}})}}async function l(e){try{await (0,o.Z)();let t=await (0,c.MH)(e,"freelancer");if(t instanceof Response)return t;let{title:r,description:a,price:i,category:n,image:s,durationDays:u}=await e.json();if(!r||!a||!i||!n)return new Response(JSON.stringify({message:"Please provide all required fields"}),{status:400,headers:{"Content-Type":"application/json"}});let l=await p.Z.create({title:r,description:a,price:i,category:n,image:s||"https://placehold.co/600x400",durationDays:u||7,freelancerId:t._id}),g=await p.Z.findById(l._id).populate({path:"freelancerId",select:"name",model:"User"});return new Response(JSON.stringify(g),{status:201,headers:{"Content-Type":"application/json"}})}catch(e){return console.error("Create gig error:",e),new Response(JSON.stringify({message:"Server error"}),{status:500,headers:{"Content-Type":"application/json"}})}}let g=new i.AppRouteRouteModule({definition:{kind:n.x.APP_ROUTE,page:"/api/gigs/route",pathname:"/api/gigs",filename:"route",bundlePath:"app/api/gigs/route"},resolvedPagePath:"E:\\rozgaar-mongodb\\frontend\\app\\api\\gigs\\route.ts",nextConfigOutput:"",userland:a}),{requestAsyncStorage:d,staticGenerationAsyncStorage:f,serverHooks:m,headerHooks:h,staticGenerationBailout:y}=g,w="/api/gigs/route";function x(){return(0,s.patchFetch)({serverHooks:m,staticGenerationAsyncStorage:f})}}};var t=require("../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),a=t.X(0,[632,110,7842,6245,9965,6592,6310,9074,781,8057,4991,423,8844,5007,6851,3079,5312,432,2385],()=>r(89097));module.exports=a})();